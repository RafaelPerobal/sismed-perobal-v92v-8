
# PLANO ESTRATÃ‰GICO DE CORREÃ‡ÃƒO E MELHORIA CONTÃNUA
# SisMed Perobal v9.0 - Sistema de Receitas MÃ©dicas 100% Offline
# VersÃ£o: 2.0 | Data: 07/07/2025
# Arquitetura: 100% Client-Side (Navegador)

================================================================================
SUMÃRIO EXECUTIVO - ATUALIZADO
================================================================================

O projeto SisMed Perobal v9.0 serÃ¡ uma aplicaÃ§Ã£o **100% offline** que roda diretamente no navegador Windows (Chrome/Edge), sem necessidade de instalaÃ§Ã£o ou empacotamento como executÃ¡vel (.exe).

DECISÃƒO ARQUITETURAL FINAL: 100% Client-Side no Navegador
- Frontend: React + Vite + TypeScript
- Banco: SQLite via sql.js (navegador)
- PDF: jsPDF + template oficial
- DistribuiÃ§Ã£o: Build estÃ¡tico + servidor local

================================================================================
1. ARQUITETURA DEFINITIVA (100% OFFLINE NO NAVEGADOR)
================================================================================

1.1 STACK TECNOLÃ“GICA CONFIRMADA:

FRONTEND: React.js + Vite + TypeScript
BANCO DE DADOS: SQLite via sql.js (client-side)
ARMAZENAMENTO: localStorage (cache leve)
GERAÃ‡ÃƒO PDF: jsPDF + template oficial
SERVIDOR: npx serve dist (local, sem dependÃªncias externas)

1.2 ELIMINAÃ‡Ã•ES CONFIRMADAS:
âŒ Electron (descartado)
âŒ Backend Flask (descartado)
âŒ ExecutÃ¡vel .exe (descartado)
âŒ Instaladores NSIS (descartado)
âŒ Chamadas HTTP/API (descartado)

1.3 FUNCIONAMENTO:
âœ… Build: npm run build
âœ… ExecuÃ§Ã£o: npx serve dist
âœ… Acesso: http://localhost:3000
âœ… Offline: 100% funcional sem internet
âœ… DistribuiÃ§Ã£o: Pasta dist + script .bat

================================================================================
2. MODELO DE DADOS SIMPLIFICADO (SQLite CLIENT-SIDE)
================================================================================

2.1 ESTRUTURA DO BANCO (sql.js):

```sql
-- Pacientes
CREATE TABLE patients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    cpf TEXT,
    data_nascimento DATE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Medicamentos Oficiais (36 itens)
CREATE TABLE medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    denominacao_generica TEXT NOT NULL,
    concentracao TEXT NOT NULL,
    apresentacao TEXT NOT NULL,
    ativo BOOLEAN DEFAULT 1
);

-- Receitas
CREATE TABLE prescriptions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    patient_id INTEGER NOT NULL,
    data_receita DATE NOT NULL,
    observacoes TEXT,
    status TEXT DEFAULT 'ativa',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (patient_id) REFERENCES patients(id)
);

-- Medicamentos da Receita
CREATE TABLE prescription_medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    prescription_id INTEGER NOT NULL,
    medicine_id INTEGER NOT NULL,
    posologia TEXT NOT NULL,
    FOREIGN KEY (prescription_id) REFERENCES prescriptions(id),
    FOREIGN KEY (medicine_id) REFERENCES medicines(id)
);
```

================================================================================
3. TEMPLATE OFICIAL DA RECEITA (ESTRUTURA FIXA)
================================================================================

3.1 LAYOUT OBRIGATÃ“RIO:

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ›ï¸ [BRASÃƒO]                    PREFEITURA DE PEROBAL
                               Cidade de todos!
                                                      Secretaria Municipal de SaÃºde

                                RECEITA MÃ‰DICA

Paciente: [NOME_COMPLETO]                    Data de Nascimento: [DD/MM/AAAA]
CPF/RG: [XXX.XXX.XXX-XX]

Medicamentos:
1. [MEDICAMENTO] [DOSAGEM] - [TIPO]
   Posologia: [FREQUÃŠNCIA] (ocultar se vazio)

[OBSERVAÃ‡Ã•ES GERAIS] (ocultar se vazio)

                                          Perobal, [DIA] de [MÃŠS] de [ANO]

                      __________________________________________________
                                 Assinatura do MÃ©dico

      Rua JaracatiÃ¡, 1060 - Telefax (044)3625-1225 - CEP. 87538-000 - PEROBAL - PARANÃ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

3.2 REGRAS DE FORMATAÃ‡ÃƒO:
- Logo: assets/logo-perobal.png (fornecida)
- Fonte: Helvetica/Arial 11-12pt
- CentralizaÃ§Ã£o: TÃ­tulo, assinatura, endereÃ§o
- Data: Formato extenso Ã  direita
- Campos opcionais: Ocultar se vazios

================================================================================
4. FUNCIONALIDADES CORE (100% CLIENT-SIDE)
================================================================================

4.1 GESTÃƒO DE PACIENTES:
âœ… Cadastro com validaÃ§Ã£o CPF
âœ… Busca por nome/CPF
âœ… EdiÃ§Ã£o e exclusÃ£o
âœ… Armazenamento local (SQLite)

4.2 MEDICAMENTOS OFICIAIS:
âœ… Lista fixa de 36 medicamentos
âœ… Busca e filtro
âœ… NÃ£o editÃ¡vel (dados oficiais)

4.3 GERAÃ‡ÃƒO DE RECEITAS:
âœ… SeleÃ§Ã£o de paciente
âœ… MÃºltiplos medicamentos + posologia
âœ… MÃºltiplas datas (sistema avanÃ§ado)
âœ… Template oficial obrigatÃ³rio
âœ… Export PDF direto no navegador

4.4 SISTEMA DE MÃšLTIPLAS RECEITAS:
âœ… AtÃ© 12 receitas por lote
âœ… Datas futuras (mÃ¡x 6 meses)
âœ… PDF Ãºnico com mÃºltiplas pÃ¡ginas
âœ… Controle de overflow por pÃ¡gina

================================================================================
5. IMPLEMENTAÃ‡ÃƒO TÃ‰CNICA ATUALIZADA
================================================================================

5.1 ESTRUTURA DE ARQUIVOS:

```
sismed-perobal-v9-offline/
â”œâ”€â”€ public/
â”‚   â””â”€â”€ assets/
â”‚       â””â”€â”€ logo-perobal.png (âœ… Implementado)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ prescriptions/ (âœ… Modularizado)
â”‚   â”‚   â”‚   â”œâ”€â”€ PrescriptionHeader.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MedicinesList.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ PrescriptionObservations.tsx
â”‚   â”‚   â”‚   â””â”€â”€ PrescriptionFooter.tsx
â”‚   â”‚   â””â”€â”€ prescription-form/ (âœ… Modularizado)
â”‚   â”‚       â”œâ”€â”€ MedicineSelector.tsx
â”‚   â”‚       â””â”€â”€ MedicineList.tsx
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ usePrescriptionForm.ts (âœ… Implementado)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ pdfGenerator.ts (âœ… Template oficial)
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts (âœ… Padronizado)
â”œâ”€â”€ dist/ (gerado por npm run build)
â”œâ”€â”€ abrir-sismed.bat (a criar)
â””â”€â”€ README_Offline.txt (a criar)
```

5.2 CORREÃ‡Ã•ES IMPLEMENTADAS:
âœ… Build errors corrigidos
âœ… PrescriptionForm modularizado
âœ… PrescriptionViewer refatorado
âœ… PDF Generator com template oficial
âœ… Logo oficial integrada
âœ… Hooks customizados criados

================================================================================
6. FASE 4 - DISTRIBUIÃ‡ÃƒO ATUALIZADA (SEM ELECTRON)
================================================================================

6.1 PROCESSO DE BUILD E DISTRIBUIÃ‡ÃƒO:

**Etapa 1: Build da AplicaÃ§Ã£o**
```bash
npm run build
# Gera pasta dist/ com arquivos estÃ¡ticos
```

**Etapa 2: Teste Local**
```bash
npx serve dist
# Acesso via http://localhost:3000
```

**Etapa 3: ValidaÃ§Ã£o Offline**
- Desconectar internet
- Verificar funcionamento completo
- Testar geraÃ§Ã£o de PDF
- Validar banco SQLite no navegador

**Etapa 4: Empacotamento para DistribuiÃ§Ã£o**
```
SisMed-Perobal-v9/
â”œâ”€â”€ dist/ (pasta completa do build)
â”œâ”€â”€ abrir-sismed.bat
â”œâ”€â”€ README_Offline.txt
â””â”€â”€ Medicamentos_Oficiais.pdf (lista de referÃªncia)
```

6.2 SCRIPT DE ABERTURA (abrir-sismed.bat):
```batch
@echo off
echo Iniciando SisMed Perobal v9.0...
echo Aguarde a abertura do navegador...
cd dist
npx serve . --single
pause
```

6.3 MANUAL DE INSTALAÃ‡ÃƒO (README_Offline.txt):
```
SISMED PEROBAL v9.0 - SISTEMA OFFLINE
====================================

REQUISITOS:
- Windows 10/11
- Google Chrome ou Microsoft Edge
- Node.js (para npx serve)

INSTALAÃ‡ÃƒO:
1. Extrair pasta SisMed-Perobal-v9 no computador
2. Executar "abrir-sismed.bat"
3. Aguardar abertura do navegador
4. Acessar: http://localhost:3000

FUNCIONAMENTO:
- 100% offline (sem internet necessÃ¡ria)
- Dados salvos localmente no navegador
- PDF gerado diretamente no browser
- Backup automÃ¡tico via localStorage

SUPORTE:
- Secretaria Municipal de SaÃºde de Perobal
- Telefax: (044) 3625-1225
```

================================================================================
7. CHECKLIST DE VALIDAÃ‡ÃƒO FINAL
================================================================================

7.1 FUNCIONALIDADES CORE:
â–¡ Cadastro de pacientes funcional
â–¡ Lista de 36 medicamentos carregada
â–¡ GeraÃ§Ã£o de receita Ãºnica
â–¡ Sistema de mÃºltiplas receitas (atÃ© 12)
â–¡ PDF com template oficial
â–¡ Funcionamento 100% offline

7.2 VALIDAÃ‡ÃƒO TÃ‰CNICA:
â–¡ npm run build sem erros
â–¡ npx serve dist funcional
â–¡ SQLite operando no navegador
â–¡ localStorage como cache
â–¡ Nenhuma dependÃªncia externa
â–¡ Compatibilidade Chrome/Edge

7.3 DISTRIBUIÃ‡ÃƒO:
â–¡ Pasta dist completa
â–¡ Script abrir-sismed.bat
â–¡ README_Offline.txt
â–¡ Logo oficial integrada
â–¡ Template receita conforme especificaÃ§Ã£o

================================================================================
8. CRONOGRAMA ATUALIZADO (5 DIAS)
================================================================================

ğŸ“… DIA 1: CorreÃ§Ãµes Finais
âœ… Build errors corrigidos
âœ… Componentes modularizados
âœ… Logo oficial integrada

ğŸ“… DIA 2: Template PDF Oficial
âœ… PDF Generator atualizado
âœ… Layout conforme especificaÃ§Ã£o
â–¡ Testes de geraÃ§Ã£o mÃºltipla

ğŸ“… DIA 3: IntegraÃ§Ã£o SQLite
â–¡ sql.js configurado
â–¡ MigraÃ§Ã£o de localStorage
â–¡ 36 medicamentos oficiais

ğŸ“… DIA 4: Testes Offline
â–¡ ValidaÃ§Ã£o sem internet
â–¡ Performance no navegador
â–¡ Compatibilidade Chrome/Edge

ğŸ“… DIA 5: Empacotamento Final
â–¡ Build otimizado
â–¡ Scripts de distribuiÃ§Ã£o
â–¡ DocumentaÃ§Ã£o completa

================================================================================
9. BENEFÃCIOS DA NOVA ARQUITETURA
================================================================================

9.1 TÃ‰CNICOS:
âœ… Sem custos de Electron
âœ… InstalaÃ§Ã£o simplificada
âœ… Funcionamento garantido offline
âœ… AtualizaÃ§Ãµes via substituiÃ§Ã£o de pasta
âœ… Compatibilidade Windows nativa

9.2 OPERACIONAIS:
âœ… DistribuiÃ§Ã£o via pendrive/email
âœ… MÃºltiplos computadores (mesmo build)
âœ… Backup automÃ¡tico localStorage
âœ… PDF oficial sem dependÃªncias
âœ… ManutenÃ§Ã£o tÃ©cnica simplificada

9.3 USUÃRIO FINAL:
âœ… Interface familiar (navegador)
âœ… Funcionamento instantÃ¢neo
âœ… Receitas com layout oficial
âœ… Sistema de mÃºltiplas datas
âœ… ImpressÃ£o direta do navegador

================================================================================
CONCLUSÃƒO
================================================================================

A arquitetura 100% client-side no navegador oferece a melhor relaÃ§Ã£o custo-benefÃ­cio para o SisMed Perobal, mantendo todas as funcionalidades planejadas sem a complexidade de empacotamento executÃ¡vel.

O sistema funcionarÃ¡ de forma robusta e confiÃ¡vel em qualquer computador Windows com navegador moderno, garantindo produtividade e conformidade com os padrÃµes oficiais da Secretaria Municipal de SaÃºde de Perobal.

================================================================================
RESPONSÃVEL TÃ‰CNICO: Sistema Atualizado
DATA DE ATUALIZAÃ‡ÃƒO: 07/07/2025
VERSÃƒO DO DOCUMENTO: 2.0
PRÃ“XIMA REVISÃƒO: 14/07/2025
================================================================================
